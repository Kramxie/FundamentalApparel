<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Account - Fundamental Apparel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Custom Scrollbar Hide */
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Specific Styles for Password Logic (Preserved) */
        .password-toggle-btn {
            position: absolute;
            top: 50%;
            right: 1rem;
            /* Adjusted for larger inputs */
            transform: translateY(-50%);
            color: #6b7280;
            cursor: pointer;
            padding: 0.5rem;
        }

        .password-toggle-btn:hover {
            color: #111827;
        }

        #password-reqs {
            list-style-type: none;
            padding: 0;
            margin-top: 0.75rem;
        }

        /* ETO YUNG FIXED LINE: align-items: center; na siya */
        #password-reqs li {
            font-size: 0.8rem;
            color: #6b7280;
            transition: color 0.2s;
            display: flex;
            align-items: center;
            margin-bottom: 2px;
        }

        #password-reqs li.valid {
            color: #10B981;
        }

        #password-reqs li i {
            width: 1.5rem;
            font-size: 0.75rem;
        }
    </style>
</head>

<body class="h-screen overflow-hidden bg-white">

    <div class="flex h-full">

        <div
            class="hidden lg:flex w-1/2 bg-gray-50 flex-col justify-center items-center p-12 text-center border-r border-gray-100">
            <div class="max-w-lg">
                <a href="index.html" class="inline-block hover:opacity-80 transition-opacity" title="Back to Homepage">
                    <img src="images/logo.png" alt="Fundamental Apparel Logo"
                        class="w-40 h-40 mx-auto mb-8 object-contain">
                </a>

                <h1 class="text-4xl font-extrabold text-gray-900 mb-2">Fundamental <span
                        class="text-gray-600">Apparel</span></h1>

                <h2 class="text-xl font-semibold text-gray-800 mt-6 mb-4">Join Fundamental Apparel</h2>

                <p class="text-gray-600 text-lg leading-relaxed">
                    Create an account to unlock exclusive deals, track your orders, and enjoy a personalized shopping
                    experience.
                </p>
            </div>
        </div>

        <div
            class="w-full lg:w-1/2 h-full overflow-y-auto hide-scrollbar bg-white flex flex-col items-center p-6 sm:p-12">

            <div class="w-full max-w-md mt-4 lg:mt-12 mb-10">

                <div class="lg:hidden text-center mb-6">
                    <a href="index.html" class="inline-block hover:opacity-80 transition-opacity">
                        <img src="images/logo.png" alt="Fundamental Apparel Logo"
                            class="w-24 h-24 mx-auto mb-4 object-contain">
                    </a>
                    <h1 class="text-2xl font-bold text-gray-900">Fundamental Apparel</h1>
                </div>

                <div class="text-left mb-8 hidden lg:block">
                    <h2 class="text-3xl font-bold text-gray-900">Create Account</h2>
                    <p class="text-gray-500 mt-2 text-lg">Sign up for a free account</p>
                </div>

                <div id="message-container" class="hidden mb-4 p-4 rounded-md text-sm"></div>

                <form id="register-form" class="space-y-5">

                    <div>
                        <label for="name" class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
                        <input type="text" id="name" name="name" required placeholder="John Doe"
                            class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-gray-900 focus:border-transparent outline-none transition bg-white text-gray-900">
                    </div>

                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                        <input type="email" id="email" name="email" required placeholder="email@domain.com"
                            class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-gray-900 focus:border-transparent outline-none transition bg-white text-gray-900">
                    </div>

                    <div>
                        <label for="password" class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                        <div class="relative">
                            <input type="password" id="password" name="password" minlength="6" required
                                placeholder="••••••••"
                                class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-gray-900 focus:border-transparent outline-none transition bg-white text-gray-900 pr-10">

                            <button type="button" class="password-toggle-btn" data-target="password">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>

                        <ul id="password-reqs" class="mt-3 bg-gray-50 p-3 rounded-md border border-gray-100">
                            <li id="req-length"><i class="fas fa-times mr-2"></i> At least 8 characters</li>
                            <li id="req-number"><i class="fas fa-times mr-2"></i> Include numbers</li>
                            <li id="req-special"><i class="fas fa-times mr-2"></i> Include special chars (!@#$%)</li>
                            <li id="req-nospace"><i class="fas fa-times mr-2"></i> No spaces</li>
                        </ul>
                    </div>

                    <div>
                        <label for="confirm-password" class="block text-sm font-medium text-gray-700 mb-1">Confirm
                            Password</label>
                        <div class="relative">
                            <input type="password" id="confirm-password" name="confirm-password" required
                                placeholder="••••••••"
                                class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-gray-900 focus:border-transparent outline-none transition bg-white text-gray-900 pr-10">

                            <button type="button" class="password-toggle-btn" data-target="confirm-password">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>

                    <div class="flex items-start gap-3">
                        <input id="agreePolicyRegister" type="checkbox" required class="mt-1 h-4 w-4" />
                        <label for="agreePolicyRegister" class="text-sm text-gray-600">By continuing, you agree to our
                            <a href="#" class="text-blue-600 hover:underline policy-link" data-open="policyModal">Privacy Policy</a>
                            and
                            <a href="#" class="text-blue-600 hover:underline policy-link" data-open="policyModal">Terms &amp; Conditions</a>.
                        </label>
                    </div>

                    <div class="pt-4">
                        <button type="submit" id="submit-btn"
                            class="w-full bg-gray-900 text-white font-bold py-3.5 rounded-lg hover:bg-black transition transform active:scale-[0.98] duration-200 shadow-md">
                            Create Account
                        </button>
                    </div>
                </form>

                <div class="relative my-8">
                    <div class="absolute inset-0 flex items-center">
                        <div class="w-full border-t border-gray-200"></div>
                    </div>
                    <div class="relative flex justify-center text-sm">
                        <span class="px-2 bg-white text-gray-500">Or sign up with</span>
                    </div>
                </div>

                <div class="space-y-3">
                    <button id="google-btn" type="button"
                        class="w-full flex items-center justify-center px-4 py-3 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition">
                        <i class="fab fa-google text-lg mr-3"></i>
                        Sign up with Google
                    </button>
                    <button id="facebook-btn" type="button"
                        class="w-full flex items-center justify-center px-4 py-3 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition">
                        <i class="fab fa-facebook text-lg mr-3 text-blue-600"></i>
                        Sign up with Facebook
                    </button>
                </div>

                <div class="text-center mt-8 pb-4">
                    <p class="text-sm text-gray-600">
                        Already have an account?
                        <a href="login.html" class="font-bold text-gray-900 hover:underline">Log in</a>
                    </p>
                </div>

            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'https://fundamental-apparel-backend.onrender.com';
        const form = document.getElementById('register-form');
        const messageContainer = document.getElementById('message-container');
        const submitBtn = document.getElementById('submit-btn');
        const passwordInput = document.getElementById('password');
        const googleBtn = document.getElementById('google-btn');
        const facebookBtn = document.getElementById('facebook-btn');

        // Password validation elements
        const reqs = {
            length: document.getElementById('req-length'),
            number: document.getElementById('req-number'),
            special: document.getElementById('req-special'),
            nospace: document.getElementById('req-nospace')
        };
        const validations = {
            length: (p) => p.length >= 8,
            number: (p) => /[0-9]/.test(p),
            special: (p) => /[!@#$%^&*]/.test(p),
            nospace: (p) => !/\s/.test(p)
        };

        // Password toggle buttons
        const toggleButtons = document.querySelectorAll('.password-toggle-btn');

        const showMessage = (message, type) => {
            messageContainer.textContent = message;
            messageContainer.className = `p-4 rounded-md mb-4 text-sm ${type === 'success' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-800'}`;
            messageContainer.classList.remove('hidden');
        };

        // Google OAuth
        googleBtn.addEventListener('click', () => {
            window.location.href = `${API_BASE}/api/auth/google`;
        });

        // Facebook OAuth
        facebookBtn.addEventListener('click', () => {
            window.location.href = `${API_BASE}/api/auth/facebook`;
        });

        // --- Show/Hide Password Logic ---
        toggleButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                const targetInput = document.getElementById(btn.dataset.target);
                const icon = btn.querySelector('i');
                if (targetInput.type === 'password') {
                    targetInput.type = 'text';
                    icon.classList.remove('fa-eye');
                    icon.classList.add('fa-eye-slash');
                } else {
                    targetInput.type = 'password';
                    icon.classList.remove('fa-eye-slash');
                    icon.classList.add('fa-eye');
                }
            });
        });

        // --- Real-time Password Validation Logic ---
        passwordInput.addEventListener('input', () => {
            const password = passwordInput.value;
            let allValid = true;

            for (const [key, test] of Object.entries(validations)) {
                const reqEl = reqs[key];
                const icon = reqEl.querySelector('i');
                if (test(password)) {
                    reqEl.classList.add('valid');
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-check');
                } else {
                    reqEl.classList.remove('valid');
                    icon.classList.remove('fa-check');
                    icon.classList.add('fa-times');
                    allValid = false;
                }
            }
            return allValid;
        });

        // --- Form Submission Logic ---
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            // Ensure agreement checkbox is checked
            const agree = document.getElementById('agreePolicyRegister');
            if(!agree || !agree.checked){
                showMessage('Please agree to the Privacy Policy and Terms & Conditions to continue.', 'error');
                return;
            }
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());
            const password = data.password;

            // 1. Client-side validation bago i-submit
            if (password !== data['confirm-password']) {
                return showMessage('Passwords do not match.', 'error');
            }

            // Check all password validations
            const isLengthValid = validations.length(password);
            const isNumberValid = validations.number(password);
            const isSpecialValid = validations.special(password);
            const isNoSpaceValid = validations.nospace(password);

            if (!isLengthValid || !isNumberValid || !isSpecialValid || !isNoSpaceValid) {
                return showMessage('Password does not meet all requirements.', 'error');
            }

            submitBtn.disabled = true;
            submitBtn.textContent = 'Creating Account...';

            try {
                const response = await fetch(`${API_BASE}/api/auth/register`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name: data.name, email: data.email, password: data.password })
                });

                const result = await response.json();
                if (result.success) {
                    alert('Registration successful! Please check your email for a verification code.');
                    window.location.href = `verify.html?email=${encodeURIComponent(data.email)}`;
                } else {
                    throw new Error(result.msg || 'Registration failed.');
                }
            } catch (error) {
                showMessage(error.message, 'error');
                submitBtn.disabled = false;
                submitBtn.textContent = 'Create Account';
            }
        });

        // Policy modal handling (register page)
            // Policy modal handling (register page)
            function openPolicyModal(){
                const modal = document.getElementById('policyModal');
                if(modal){
                    modal.classList.remove('hidden');
                    modal.classList.add('flex');
                }
            }
            function closePolicyModal(){
                const modal = document.getElementById('policyModal');
                if(modal){
                    modal.classList.add('hidden');
                    modal.classList.remove('flex');
                }
            }
            document.querySelectorAll('.policy-link').forEach(a=>{
                a.addEventListener('click', (ev)=>{ ev.preventDefault(); openPolicyModal(); });
            });
            document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closePolicyModal(); });
            document.addEventListener('click', (e)=>{
                const modal = document.getElementById('policyModal');
                if(!modal) return;
                if(e.target && (e.target.id === 'policyClose' || (e.target.closest && e.target.closest('#policyClose')))) {
                    closePolicyModal();
                    return;
                }
                if(e.target && e.target.id === 'policyModal') {
                    closePolicyModal();
                }
            });
            (function(){
                const modal = document.getElementById('policyModal');
                if(modal){
                    modal.addEventListener('click', (ev)=>{ if(ev.target === modal) closePolicyModal(); });
                }
            })();
    </script>

        <!-- Policy Modal (contains Privacy Policy and Terms & Conditions) -->
        <div id="policyModal" class="hidden fixed inset-0 bg-black/60 z-50 items-center justify-center" role="dialog" aria-modal="true" aria-labelledby="policyTitle" tabindex="-1">
            <div class="bg-white max-w-4xl w-[90%] max-h-[85vh] overflow-y-auto rounded-lg p-6 mx-auto shadow-lg ring-1 ring-black/5">
                <div class="flex items-center justify-between gap-4 mb-4">
                    <h2 id="policyTitle" class="text-2xl font-semibold text-gray-900">Privacy Policy &amp; Terms &amp; Conditions</h2>
                    <button id="policyClose" class="text-gray-600 hover:text-gray-900 bg-gray-100 px-3 py-1 rounded-md">Close ✕</button>
                </div>
                <div class="prose text-sm text-gray-700">
                    <section class="space-y-3">
                        <h3 class="text-lg font-semibold text-gray-900">Privacy Policy</h3>
                        <p class="leading-relaxed">Fundamental Apparel collects and processes personal information necessary to provide our services, manage orders, and communicate with customers. We collect contact information (name, email, phone), shipping addresses, order history, and any files you upload when using our Custom Upload services. Images and files uploaded as part of reviews or custom orders are stored securely and are accessible to staff for fulfillment and moderation purposes.</p>
                        <p class="leading-relaxed">We use this information to fulfill orders, provide customer support, send transactional emails (order confirmations, shipping updates), and for fraud prevention. We do not sell personal data to third parties. For payment processing we share only necessary data with payment providers. You may request data access or deletion by contacting support.</p>
                    </section>

                    <section class="space-y-3 mt-4">
                        <h3 class="text-lg font-semibold text-gray-900">Data and Image Usage</h3>
                        <p class="leading-relaxed">By uploading images (reviews or custom designs), you grant Fundamental Apparel a non-exclusive license to store and process those images for the purpose of order fulfillment, displaying reviews (if allowed), and customer service. If an uploaded image contains sensitive content, please contact support to request removal.</p>
                    </section>

                    <section class="space-y-3 mt-4">
                        <h3 class="text-lg font-semibold text-gray-900">Terms &amp; Conditions</h3>
                        <p class="leading-relaxed">Orders are subject to stock availability and our inventory checks. Custom orders submitted via the Custom Upload flow are quotes and require confirmation. Payments, refunds, and returns are handled according to our Returns &amp; Refunds policy. Service orders may be excluded from loyalty rewards; admin controls apply.</p>
                        <p class="leading-relaxed">Customers must provide accurate contact and shipping information. We reserve the right to cancel or modify orders in case of inventory errors, pricing mistakes, or suspected fraud. By creating an account and placing orders you agree to pay applicable fees and follow our usage guidelines.</p>
                    </section>

                    <section class="space-y-2 mt-4">
                        <h3 class="text-lg font-semibold text-gray-900">Contact</h3>
                        <p class="leading-relaxed">If you have questions about privacy or these terms, contact us at <a href="mailto:support@fundamental.example" class="text-indigo-600 hover:underline">support@fundamental.example</a> (replace with your operational support email) or through the admin contact channels.</p>
                    </section>
                </div>
            </div>
        </div>
</body>

</html>